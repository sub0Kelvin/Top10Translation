
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="OWASP Top 10:2021">
      
      
      
      
        <link rel="prev" href="../A02_2021-Cryptographic_Failures/">
      
      
        <link rel="next" href="../A04_2021-Insecure_Design/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>A03:2021 – Injection - OWASP Top 10:2021</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bcfcd587.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#a032021-injection" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../" title="OWASP Top 10:2021" class="md-header__button md-logo" aria-label="OWASP Top 10:2021" data-md-component="logo">
      
  <img src="../../assets/OWASP_Logo_Transp.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OWASP Top 10:2021
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              A03:2021 – Injection
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../" hreflang="en" class="md-select__link">
              en - English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../ar/" hreflang="ar" class="md-select__link">
              ar - ﺎﻠﻋﺮﺒﻳﺓ
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../" hreflang="de" class="md-select__link">
              de - Deutsch
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../es/" hreflang="es" class="md-select__link">
              es - Español
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../fr/" hreflang="fr" class="md-select__link">
              fr - Français
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../id/" hreflang="id" class="md-select__link">
              id - Indonesian
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../it/" hreflang="it" class="md-select__link">
              it - Italiano
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../ja/" hreflang="ja" class="md-select__link">
              ja - 日本語
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../pt_BR/" hreflang="pt_BR" class="md-select__link">
              pt_BR - Português (Brasil)
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../zh_CN/" hreflang="zh_CN" class="md-select__link">
              zh_CN - 简体中文
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../zh_TW/" hreflang="zh_TW" class="md-select__link">
              zh_TW - 繁體中文
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/OWASP/Top10" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/Top10
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../" title="OWASP Top 10:2021" class="md-nav__button md-logo" aria-label="OWASP Top 10:2021" data-md-component="logo">
      
  <img src="../../assets/OWASP_Logo_Transp.png" alt="logo">

    </a>
    OWASP Top 10:2021
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/OWASP/Top10" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/Top10
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Startseite
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../0x00-notice/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Anmerkung
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../A00_2021_Introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Einführung
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../A00_2021_How_to_use_the_OWASP_Top_10_as_a_standard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wie man die OWASP Top 10 als Standard verwendet
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../A00_2021-How_to_start_an_AppSec_program_with_the_OWASP_Top_10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wie man ein AppSec-Program mit den OWASP Top 10 beginnt
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../A00-about-owasp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Über OWASP
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Liste der Top 10:2021
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Liste der Top 10:2021
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A01_2021-Broken_Access_Control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A01 - Mangelhafte Zugriffskontrolle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A02_2021-Cryptographic_Failures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A02 - Fehlerhafter Einsatz von Kryptographie
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    A03 - Injection
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    A03 - Injection
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#beurteilungskriterien" class="md-nav__link">
    <span class="md-ellipsis">
      Beurteilungskriterien
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ubersicht" class="md-nav__link">
    <span class="md-ellipsis">
      Übersicht
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#beschreibung" class="md-nav__link">
    <span class="md-ellipsis">
      Beschreibung
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pravention-und-gegenmanahmen" class="md-nav__link">
    <span class="md-ellipsis">
      Prävention und Gegenmaßnahmen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#beispielhafte-angriffsszenarien" class="md-nav__link">
    <span class="md-ellipsis">
      Beispielhafte Angriffsszenarien
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenzen" class="md-nav__link">
    <span class="md-ellipsis">
      Referenzen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#liste-der-zugeordneten-cwes" class="md-nav__link">
    <span class="md-ellipsis">
      Liste der zugeordneten CWEs
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A04_2021-Insecure_Design/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A04 - Unsicheres Anwendungsdesign
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A05_2021-Security_Misconfiguration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A05 - Sicherheitsrelevante Fehlkonfiguration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A06_2021-Vulnerable_and_Outdated_Components/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A06 - Unsichere oder veraltete Komponenten
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A07_2021-Identification_and_Authentication_Failures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A07 - Fehlerhafte Authentifizierung
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A08_2021-Software_and_Data_Integrity_Failures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A08 - Fehlerhafte Prüfung der Software- und Datenintegrität
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A09_2021-Security_Logging_and_Monitoring_Failures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A09 - Unzureichendes Logging und Sicherheitsmonitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A10_2021-Server-Side_Request_Forgery_%28SSRF%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A10 - Server-Side Request Forgery (SSRF)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../A11_2021-Next_Steps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nächste Schritte
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#beurteilungskriterien" class="md-nav__link">
    <span class="md-ellipsis">
      Beurteilungskriterien
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ubersicht" class="md-nav__link">
    <span class="md-ellipsis">
      Übersicht
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#beschreibung" class="md-nav__link">
    <span class="md-ellipsis">
      Beschreibung
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pravention-und-gegenmanahmen" class="md-nav__link">
    <span class="md-ellipsis">
      Prävention und Gegenmaßnahmen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#beispielhafte-angriffsszenarien" class="md-nav__link">
    <span class="md-ellipsis">
      Beispielhafte Angriffsszenarien
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referenzen" class="md-nav__link">
    <span class="md-ellipsis">
      Referenzen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#liste-der-zugeordneten-cwes" class="md-nav__link">
    <span class="md-ellipsis">
      Liste der zugeordneten CWEs
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="a032021-injection">A03:2021 – Injection     <img align="right" alt="icon" src="../assets/TOP_10_Icons_Final_Injection.png" style="height:80px;width:80px" />  <a id="osib.owasp.top10.2021-1-0.3"></a></h1>
<h2 id="beurteilungskriterien">Beurteilungskriterien <a id="osib.owasp.top10.2021-1-0.3.factors"></a></h2>
<table>
<thead>
<tr>
<th style="text-align: center;">Zugeordnete CWEs</th>
<th style="text-align: center;">Maximale Häufigkeit</th>
<th style="text-align: center;">Durchschn. Häufigkeit</th>
<th style="text-align: center;">Durchschn. Ausnutzbarkeit (gewichtet)</th>
<th style="text-align: center;">Durchschn. Auswirkungen (gewichtet)</th>
<th style="text-align: center;">Maximale Abdeckung</th>
<th style="text-align: center;">Durchschnittliche Abdeckung</th>
<th style="text-align: center;">Gesamtanzahl</th>
<th style="text-align: center;">CVEs insgesamt</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">33</td>
<td style="text-align: center;">19.09 %</td>
<td style="text-align: center;">3.37 %</td>
<td style="text-align: center;">7.25</td>
<td style="text-align: center;">7.15</td>
<td style="text-align: center;">94.04 %</td>
<td style="text-align: center;">47.90 %</td>
<td style="text-align: center;">274,228</td>
<td style="text-align: center;">32,078</td>
</tr>
</tbody>
</table>
<h2 id="ubersicht">Übersicht <a id="osib.owasp.top10.2021-1-0.3.overview"></a></h2>
<p>Die Injection rutscht von der ersten auf die dritte Position ab. 94 % der Anwendungen wurden auf irgendeine Form der Injection getestet, mit einer maximalen Häufigkeit von 19,09 %, einer durchschnittlichen Häufigkeit von 3,37 % und über 274.000 Vorkommnissen. Zu den wichtigsten Common Weakness Enumerations (CWEs) zählen <em>CWE-79: Cross-Site Scripting</em>, <em>CWE-89: SQL Injection</em> und <em>CWE-73: External Control of File Name or Path</em>.</p>
<h2 id="beschreibung">Beschreibung <a id="osib.owasp.top10.2021-1-0.3.description"></a></h2>
<p>Eine Anwendung ist für diesen Angriff anfällig, wenn:</p>
<ul>
<li>
<p>Daten, die von Mitgliedern stammen, von der Anwendung nicht ausreichend validiert, gefiltert oder bereinigt werden.</p>
</li>
<li>
<p>Dynamische Anfragen oder nicht-parametrisierte Aufrufe ohne ein dem Kontext entsprechendes Escaping direkt einem Interpreter übergeben werden.</p>
</li>
<li>
<p>Bösartige Daten innerhalb von ORM („Object-Relational Mapping“)-Suchparametern genutzt werden können, um vertrauliche Datensätze von Dritten zu extrahieren.</p>
</li>
<li>
<p>Bösartige Daten direkt oder als Teil zusammengesetzter dynamischer Querys verwendet werden. Die SQL-Abfragen oder Befehle beinhalten die Struktur und die schädlichen Daten in den dynamischen Querys, Befehlen oder Stored Procedures</p>
</li>
</ul>
<p>Zu den häufigeren Injection Arten gehören SQL, NoSQL, OS-Befehle, Object Relational Mapping (ORM), LDAP und Expression Language (EL) oder Object Graph Navigation Library (OGNL). Das Grundkonzept eines Injection-Angriffs ist für alle Interpreter gleich. Ein Quellcode Review ist die beste Methode, um Injection-Schwachstellen in Anwendungen zu finden. Ausführliches (ggf. automatisiertes) Testen aller Parameter und Variablen, Header-, URL-, Cookies-, JSON-, SOAP- und XML-Eingaben wird dringend empfohlen. Statische (SAST, Quellcode-Ebene), dynamische (DAST, laufende Anwendung) und interaktive (IAST, Mischform aus statisch und dynamisch) Test-Werkzeuge können von Organisationen für ihre CI/CD-Pipeline genutzt werden, um neue Schwachstellen noch vor einer möglichen Auslieferung in Produktivsysteme zu identifizieren.</p>
<h2 id="pravention-und-gegenmanahmen">Prävention und Gegenmaßnahmen <a id="osib.owasp.top10.2021-1-0.3.how to prevent"></a></h2>
<p>Eine konsequente Trennung von Daten, Suchanfragen und Befehlen ist für die Vermeidung von Injection-Angriffen unerlässlich:</p>
<ul>
<li>
<p>Die bevorzugte Methode ist die Verwendung einer sicheren API, die die Verwendung des Interpreters vollständig vermeidet, eine parametrisierte Schnittstelle bereitstellt oder in objektrelationale Mapping-Tools (ORMs) umwandelt. 
<br/> <strong>Anmerkung:</strong> Stored Procedures können - auch parametrisiert - immer noch SQL-Injections ermöglichen, wenn PL/SQL oder T-SQL Anfragen und Eingabedaten konkateniert oder mit EXECUTE IMMEDIATE oder exec() ausgeführt werden.</p>
</li>
<li>
<p>Für die serverseitige Eingabe-Validierung empfiehlt sich die Nutzung eines Positivlisten(“Whitelist”)-Ansatzes. Dies ist i. A. kein vollständiger Schutz, da viele Anwendungen Sonderzeichen z. B. in Textfelder oder APIs für mobile Anwendungen benötigen.</p>
</li>
<li>
<p>Für jede noch verbliebene dynamische Query müssen Sonderzeichen für den jeweiligen Interpreter mit der richtigen Escape-Syntax entschärft werden. <br/> <strong>Anmerkung:</strong> Ein Escaping von SQL-Bezeichnern, wie z. B. die Namen von Tabellen oder Spalten usw. ist nicht möglich.
Falls Mitglieder solche Bezeichner selbst eingeben können, so ist dies durchaus gefährlich. Dies ist eine übliche Schwachstelle bei Software, die Reports aus einer Datenbank erstellt.</p>
</li>
<li>
<p>SQL-Querys sollten LIMIT oder andere SQL-Controls verwenden, um den möglichen Massen-Abfluss von Daten zu verhindern.</p>
</li>
</ul>
<h2 id="beispielhafte-angriffsszenarien">Beispielhafte Angriffsszenarien <a id="osib.owasp.top10.2021-1-0.3.example attack scenarios"></a></h2>
<p><strong>Szenario Nr. 1:</strong> Eine Anwendung nutzt ungeprüfte Eingabedaten für den Zusammenbau der folgenden verwundbaren SQL-Abfrage:</p>
<pre><code>String query = &quot;SELECT \* FROM Accounts WHERE custID='&quot; + request.getParameter(&quot;id&quot;) + &quot;'&quot;;
</code></pre>
<p><strong>Szenario Nr. 2:</strong> Auch das blinde Vertrauen in Frameworks kann zu Querys führen, die ganz analog zu obigem Beispiel verwundbar sind (z. B. Hibernate Query Language (HQL)):</p>
<pre><code>Abfrage HQLQuery = session.createQuery(&quot;FROM Accounts WHERE custID='&quot; + request.getParameter(&quot;id&quot;) + &quot;'&quot;);
</code></pre>
<p>In beiden Fällen können Angreifende den ‘id’-Parameter im Browser ändern und sendet: „UNION SLEEP(10);--“. Zum Beispiel:</p>
<pre><code>http://example.com/app/accountView?id=' UNION SELECT SLEEP(10);--
</code></pre>
<p>Hierdurch wird die Logik der Anfrage verändert, so dass alle Datensätze der Tabelle „accounts“ ohne Einschränkung auf einen Kunden zurückgegeben werden.
Gefährlichere Attacken wären z. B. das Ändern oder Löschen von Daten oder das Aufrufen von Stored Procedures.</p>
<h2 id="referenzen">Referenzen <a id="osib.owasp.top10.2021-1-0.3.references"></a></h2>
<ul>
<li><a href="https://github.com/OWASP/www-project-proactive-controls/blob/master/v3/en/c3-secure-database.md">OWASP Proactive Controls: C3: Secure Database Access</a> <!-- <a href="https://owasp.org/ www-project-proactive-controls/v3/en/c3-secure-database">OWASP Proactive Controls: Sicherer Datenbankzugriff</a> --></li>
<li><a href="https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#4-0-5">OWASP Application Security Verification Standard (ASVS): V5 Validation, Sanitization and Encoding</a> <!--- <a href="https://owasp.org/www -project-application-security-verification-standard">OWASP ASVS: V5 Input Validation and Encoding</a> ---></li>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection">OWASP Web Security Testing Guide: Testing for SQL Injection</a>, <!-- <a href="https://owasp.org/www -project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection">OWASP-Testhandbuch: SQL-Injection</a> --> <a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/12-Testing_for_Command_Injection">Testing for Command Injection</a>, <!-- <a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/12 -Testing_for_Command_Injection">Command Injection </a> -->
<a href="https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.7-Testing_for_ORM_Injection">Testing for ORM Injection</a> <!-- <a href="https://owasp.org/ www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.7-Testing_for_ORM_Injection">ORM-Injektion </a> --></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet">OWASP Cheat Sheet Series: Injection Prevention Cheat Sheet</a> <!-- <a href="https://cheatsheetseries.owasp. org/cheatsheets/Injection_Prevention_Cheat_Sheet.html">OWASP Spickzettel: Injektionsprävention</a> --></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet">OWASP Cheat Sheet Series: SQL Injection Prevention Cheat Sheet</a> <!-- <a href="https://cheatsheetseries. owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html">OWASP-Spickzettel: SQL-Injection-Prävention</a> --></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_in_Java_Cheat_Sheet">OWASP Cheat Sheet Series: Injection Prevention in Java Cheat Sheet</a> <!-- [OWASP Cheat Sheet: Injection Prevention in Java](https:// (cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet_in_Java.html) --></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet">OWASP Cheat Sheet Series: Query Parameterization Cheat Sheet</a> <!-- <a href="https://cheatsheetseries.owasp. org/cheatsheets/Query_Parameterization_Cheat_Sheet.html">OWASP Spickzettel: Abfrageparametrisierung</a> --></li>
<li><a href="https://owasp.org/www-project-automated-threats-to-web-applications/assets/oats/EN/OAT-014_Vulnerability_Scanning">OWASP Automated Threats to Web Applications: OAT-014 Vulnerability Scanning</a> <!--- <a href="https://owasp.org/www -project-automated-threats-to-web-applications/">OWASP Automatisierte Bedrohungen für Webanwendungen – OAT-014</a> ---></li>
<li><a href="https://portswigger.net/kb/issues/00101080_serversidetemplateinjection">Portswigger Issue Definitions: Server-side template injection</a> <!--- <a href="https://portswigger.net/kb/issues/00101080_serversidetemplateinjection">PortSwigger: Serverseitige Vorlageninjektion </a> ---></li>
</ul>
<h2 id="liste-der-zugeordneten-cwes">Liste der zugeordneten CWEs <a id="osib.owasp.top10.2021-1-0.3.mapped cwes"></a></h2>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a> <!-- <a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Unsachgemäße Eingabevalidierung</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/74.html">CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')</a> <!-- <a href="https://cwe.mitre.org/data/definitions/74.html">CWE-74: Unsachgemäße Neutralisierung spezieller Elemente in der Ausgabe, die von einer nachgeschalteten Komponente verwendet wird ('Injektion')</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/75.html">CWE-75: Failure to Sanitize Special Elements into a Different Plane (Special Element Injection)</a> <!-- <a href="https://cwe.mitre.org/data/definitions/75.html">CWE-75: Fehler beim Bereinigen spezieller Elemente in einer anderen Ebene (Spezielle Elementinjektion )</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/77.html">CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')</a> <!-- <a href="https://cwe.mitre.org/data/definitions/77.html">CWE-77: Unsachgemäße Neutralisierung spezieller Elemente, die in einem Befehl verwendet werden ('Command Injection')</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/78.html">CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')</a> <!-- <a href="https://cwe.mitre.org/data/definitions/78.html">CWE-78: Unsachgemäße Neutralisierung spezieller Elemente, die in einem OS-Befehl verwendet werden ('OS Befehlsinjektion')</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a> <!-- <a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Unsachgemäße Neutralisierung von Eingaben während der Webseitengenerierung („Cross-site Scripting')</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</a> <!-- <a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80: Unsachgemäße Neutralisierung skriptbezogener HTML-Tags in einer Webseite (Grundlegendes XSS)</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/83.html">CWE-83: Improper Neutralization of Script in Attributes in a Web Page</a> <!-- <a href="https://cwe.mitre.org/data/definitions/83.html">CWE-83: Unsachgemäße Neutralisierung von Skripten in Attributen auf einer Webseite</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/87.html">CWE-87: Improper Neutralization of Alternate XSS Syntax</a> <!-- <a href="https://cwe.mitre.org/data/definitions/87.html">CWE-87: Unsachgemäße Neutralisierung der alternativen XSS-Syntax</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/88.html">CWE-88: Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')</a> <!-- <a href="https://cwe.mitre.org/data/definitions/88.html">CWE-88: Unsachgemäße Neutralisierung von Argumenttrennzeichen in einem Befehl („Argument Injection“ )</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/89.html">CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')</a> <!-- <a href="https://cwe.mitre.org/data/definitions/89.html">CWE-89: Unsachgemäße Neutralisierung spezieller Elemente, die in einem SQL-Befehl verwendet werden ('SQL Injection')</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/90.html">CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')</a> <!-- <a href="https://cwe.mitre.org/data/definitions/90.html">CWE-90: Unsachgemäße Neutralisierung spezieller Elemente, die in einer LDAP-Abfrage verwendet werden ('LDAP Injection')</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/91.html">CWE-91: XML Injection (aka Blind XPath Injection)</a> <!-- <a href="https://cwe.mitre.org/data/definitions/91.html">CWE-91: XML-Injection (auch bekannt als Blind XPath Injection)</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/93.html">CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')</a> <!-- <a href="https://cwe.mitre.org/data/definitions/93.html">CWE-93: Unsachgemäße Neutralisierung von CRLF-Sequenzen ('CRLF-Injection')</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/94.html">CWE-94: Improper Control of Generation of Code ('Code Injection')</a> <!-- [CWE-94: Unsachgemäße Kontrolle der Codegenerierung („Code-Injection“)] (https://cwe.mitre.org/data/definitions/94.html) --></li>
<li><a href="https://cwe.mitre.org/data/definitions/95.html">CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')</a> <!-- <a href="https://cwe.mitre.org/data/definitions/95.html">CWE-95: Unsachgemäße Neutralisierung von Anweisungen in dynamisch ausgewertetem Code ('Eval Injection“ )</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/96.html">CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')</a> <!-- <a href="https://cwe.mitre.org/data/definitions/96.html">CWE-96: Unsachgemäße Neutralisierung von Anweisungen in statisch gespeichertem Code ('Static Code Injection')</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/97.html">CWE-97: Improper Neutralization of Server-Side Includes (SSI) Within a Web Page</a> <!-- <a href="https://cwe.mitre.org/data/definitions/97.html">CWE-97: Unsachgemäße Neutralisierung von Server-Side Includes (SSI) innerhalb eines Webs Seite</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/98.html">CWE-98: Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')</a> <!-- <a href="https://cwe.mitre.org/data/definitions/98.html">CWE-98: Unsachgemäße Kontrolle des Dateinamens für die Include/Require-Anweisung im PHP-Programm ('PHP Remote File Inclusion')</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/99.html">CWE-99: Improper Control of Resource Identifiers ('Resource Injection')</a> <!-- <a href="https://cwe.mitre.org/data/definitions/99.html">CWE-99: Unsachgemäße Kontrolle von Ressourcenkennungen („Ressourceninjektion“)</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/100.html">CWE-100: DEPRECATED: Technology-Specific Input Validation Problems (CWE CATEGORY)</a> <!-- <a href="https://cwe.mitre.org/data/definitions/100.html">CWE-100: Veraltet: War ein Allheilmittel für Eingabevalidierungsprobleme</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/113.html">CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')</a> <!-- <a href="https://cwe.mitre.org/data/definitions/113.html">CWE-113: Unsachgemäße Neutralisierung von CRLF-Sequenzen in HTTP-Headern (HTTP Response Splitting)</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a> <!-- <a href="https://cwe mitre.org/data/definitions/116.html">CWE-116: Unsachgemäße Kodierung oder Escapezeichen der Ausgabe</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/138.html">CWE-138: Improper Neutralization of Special Elements</a> <!-- <a href="https://cwe.mitre.org/data/definitions/138.html">CWE-138: Unsachgemäße Neutralisierung spezieller Elemente</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/184.html">CWE-184: Incomplete List of Disallowed Inputs</a> <!-- <a href="https://cwe.mitre.org/data/definitions/184.html">CWE-184: Unvollständige Liste unzulässiger Eingaben</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/470.html">CWE-470: Use of Externally-Controlled Input to Select Classes or Code ('Unsafe Reflection')</a> <!-- <a href="https://cwe.mitre.org/data/definitions/470.html">CWE-470: Verwendung extern gesteuerter Eingaben zur Auswahl von Klassen oder Code (' Unsichere Reflexion')</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/471.html">CWE-471: Modification of Assumed-Immutable Data (MAID)</a> <!-- <a href="https://cwe.mitre.org/data/definitions/471.html">CWE-471: Änderung angenommener unveränderlicher Daten (MAID)</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/564.html">CWE-564: SQL Injection: Hibernate</a> <!-- <a href="https://cwe.mitre.org/data/definitions/564.html">CWE-564: SQL-Injection: Ruhezustand</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/610.html">CWE-610: Externally Controlled Reference to a Resource in Another Sphere</a> <!-- <a href="https://cwe.mitre.org/data/definitions/610.html">CWE-610: Extern gesteuerter Verweis auf eine Ressource in einer anderen Sphäre</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/643.html">CWE-643: Improper Neutralization of Data within XPath Expressions ('XPath Injection')</a> <!-- <a href="https://cwe.mitre.org/data/definitions/643.html">CWE-643: Unsachgemäße Neutralisierung von Daten in XPath-Ausdrücken („XPath-Injection“) </a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/644.html">CWE-644: Improper Neutralization of HTTP Headers for Scripting Syntax</a> <!-- <a href="https://cwe.mitre.org/data/definitions/644.html">CWE-644: Unsachgemäße Neutralisierung von HTTP-Headern für die Skriptsyntax</a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/652.html">CWE-652: Improper Neutralization of Data within XQuery Expressions ('XQuery Injection')</a> <!-- <a href="https://cwe.mitre.org/data/definitions/652.html">CWE-652: Unsachgemäße Neutralisierung von Daten in XQuery-Ausdrücken („XQuery-Injection“) </a> --></li>
<li><a href="https://cwe.mitre.org/data/definitions/917.html">CWE-917: Improper Neutralization of Special Elements used in an Expression Language Statement ('Expression Language Injection')</a> <!-- <a href="https://cwe.mitre.org/data/definitions/917.html">CWE-917: Unsachgemäße Neutralisierung spezieller Elemente, die in einer Ausdruckssprachenanweisung verwendet werden (' Expression Language Injection')</a> --></li>
</ul>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      © Copyright 2021 - OWASP Top 10 team - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.en_US">Creative Commons Attribution 3.0 Unported License</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>